(self.webpackChunkjiachang=self.webpackChunkjiachang||[]).push([["main"],{w6CO:(n,e,r)=>{"use strict";function a(n,o){var t=[].concat((o=void 0===o?"":o).matchAll(c)),i=new Map(t.map(function(n,e){var r=Number.parseInt(n[1],10),e=t[e+1],e=e?e.index:o.length;return[r-1,o.slice(null!=(n=n.index)?n:0,e)]}));return n.split("\n").map(function(n,e){var r=i.get(e);return e+1+": "+n+(r?"\n\n^^^"+r:"")})}function s(n,e,r){var o=n.createShader(r);if(!o)throw new Error("Failed to create shader");if(n.shaderSource(o,e),n.compileShader(o),n.getShaderParameter(o,n.COMPILE_STATUS))return o;throw r=null!=(r=n.getShaderInfoLog(o))?r:"",n.deleteShader(o),new Error("Failed to compile shader: "+r+"\n"+a(e,r).toString())}function l(i,n,e,r){var o=i.createProgram();if(!o)throw new Error("Failed to create program");if(n.forEach(function(n){i.attachShader(o,n)}),e&&e.forEach(function(n,e){i.bindAttribLocation(o,r?r[e]:e,n)}),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS))return o;throw e=i.getProgramInfoLog(o),i.deleteProgram(o),new Error("Error in program linking: "+(null!=e?e:"")+"\n"+n.map(function(n){var e,r,o,t=a(null!=(t=i.getShaderSource(n))?t:""),n=i.getShaderParameter(n,i.SHADER_TYPE);return e=i,r=n,o=[],Object.keys(e).forEach(function(n){e[n]===r&&o.push(n)}),(0<o.length?o.join(" | "):r)+":\n"+t.toString()}).join("\n"))}var o,t=r("i8i4"),d=r("q1tI"),i=r("TSYQ"),v=r.n(i),c=(r("07d7"),r("JfAA"),r("FZtP"),r("oVuX"),r("2B1R"),r("tl/u"),r("ma9I"),r("ofBz"),r("4mDm"),r("Tskq"),r("PKPk"),r("3bBZ"),r("JevA"),r("qePV"),r("+2oP"),r("rB9j"),r("EnZy"),r("tkto"),/error:\s*\d+:(\d+)/gi),f=["VERTEX_SHADER","FRAGMENT_SHADER"],u="#version 300 es\n\nin vec2 a_Position;\nin vec2 a_TexCoord;\nuniform vec2 u_Resolution;\nout vec2 v_TexCoord;\n\nvoid main() {\n  vec2 zeroToOne = a_Position / u_Resolution;\n  vec2 zeroToTwo = zeroToOne * 2.0;\n  vec2 clipSpace = zeroToTwo - 1.0;\n\n  gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n  v_TexCoord = a_TexCoord;\n}\n";(p=o=o||{}).Origin="Origin",p.Gray="Gray",p.RevertBlueAndRed="RevertBlueAndRed",p.Blur="Blur",p.Random="Random";var m=((i={})[o.Origin]=[u,"#version 300 es\n\nprecision highp float;\n\nuniform sampler2D u_Image;\nin vec2 v_TexCoord;\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(u_Image, v_TexCoord);\n}\n"],i[o.Gray]=[u,"#version 300 es\n\nprecision highp float;\n\nuniform sampler2D u_Image;\nin vec2 v_TexCoord;\nout vec4 outColor;\n\nvoid main() {\n  vec4 color = texture(u_Image, v_TexCoord);\n  float average = (color.r + color.g + color.b) / 3.0;\n  outColor = vec4(average, average, average, color.a);\n}\n"],i[o.RevertBlueAndRed]=[u,"#version 300 es\n\nprecision highp float;\n\nuniform sampler2D u_Image;\nin vec2 v_TexCoord;\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(u_Image, v_TexCoord).bgra;\n}\n"],i[o.Blur]=[u,"#version 300 es\n\nprecision highp float;\n\nuniform sampler2D u_Image;\nuniform vec2 u_Resolution;\nin vec2 v_TexCoord;\nout vec4 outColor;\n\nfloat weight[9] = float[] (0.0947416, 0.118318, 0.0947416, 0.118318, 0.147761, 0.118318, 0.0947416, 0.118318, 0.0947416);\n\nvoid main() {\n  vec4 color;\n\n  for(int i = 0; i < 9; i++) {\n    vec2 coord;\n    coord.x = v_TexCoord.x + float(i % 3 - 1) / u_Resolution.x;\n    coord.y = v_TexCoord.y + float(int(i / 3) - 1) / u_Resolution.y;\n    color = color + texture(u_Image, coord) * weight[i];\n  }\n\n  outColor = color;\n}\n"],i[o.Random]=[u,"#version 300 es\n\nprecision highp float;\n\nuniform sampler2D u_Image;\nuniform vec2 u_Resolution;\nin vec2 v_TexCoord;\nout vec4 outColor;\n\nfloat random(vec2 st) {\n  return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main() {\n  vec2 st = v_TexCoord.xy / u_Resolution.xy * 20000.0;\n  vec2 ipos = floor(st);\n  vec3 color = vec3(random(ipos));\n  vec4 tex = texture(u_Image, v_TexCoord);\n\n  outColor = vec4(tex.rgb * 0.2 + color * 0.8, 1.0);\n}\n"],i);const h=r.p+"images/img.2552a77d.jpeg";var g=r("HaE+");r("ls82"),r("z8NH"),r("moxL"),r("qXVe"),r("c162"),r("waxf"),r("0TkE"),r("Onu3"),r("1dYe"),r("gvgV"),r("6R/c"),r("YL0P"),r("X5Zq"),r("MoCz"),r("P8wP"),r("ypFw"),r("JaFt"),r("zSZm"),r("PF2M"),r("KVSy"),r("ZJ55"),r("IZzc"),r("Fwt+"),r("s5qe"),r("cvf0"),r("5s+n");function _(){return(_=(0,g.Z)(regeneratorRuntime.mark(function n(a,c,u){var s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=void 0,i=(t=a).createVertexArray(),t.bindVertexArray(i),r=c,o=void 0,o=(e=a).getAttribLocation(r,"a_Position"),r=e.createBuffer(),e.enableVertexAttribArray(o),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),s={positionBuffer:r}.positionBuffer,n.next=4,function(){return T.apply(this,arguments)}(a,c,u);case 4:(t=a).viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),i=c,o=s,r=e=void 0,e=(t=a).getUniformLocation(i,"u_Resolution"),r=t.getUniformLocation(i,"u_Image"),t.useProgram(i),t.uniform2f(e,t.canvas.width,t.canvas.height),t.uniform1i(r,0),t.bindBuffer(t.ARRAY_BUFFER,o),function(n){var e=n.canvas.width,r=n.canvas.height;n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,e,0,0,r,0,r,e,0,e,r]),n.STATIC_DRAW)}(t),t.drawArrays(t.TRIANGLES,0,6);case 6:case"end":return n.stop()}var e,r,o,t,i},n)}))).apply(this,arguments)}function T(){return(T=(0,g.Z)(regeneratorRuntime.mark(function n(e,r,o){var t,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.getAttribLocation(r,"a_TexCoord"),t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),i=e.createTexture(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),n.next=15,function(n){var e=new Image;return e.src=n,new Promise(function(n){e.addEventListener("load",function(){n(e)})})}(o);case 15:i=n.sent,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i);case 17:case"end":return n.stop()}},n)}))).apply(this,arguments)}var p=r("LboF"),u=r.n(p),i=r("9nyN"),p={insert:"head",singleton:!1};u()(i.Z,p);const x=i.Z.locals||{};var R=r("nKUr");const E=function(n){var i=n.type,a=(0,d.useRef)({}),n=(0,d.useState)(null),e=n[0],c=n[1],n=(0,d.useState)(null),r=n[0],u=n[1];(0,d.useEffect)(function(){a.current.width=Math.floor(.6*window.innerWidth),a.current.height=Math.floor(.7*window.innerHeight);var n=a.current.getContext("webgl2");if(!n)throw new Error("Failed to get WebGL2 context");c(n);var r,e,o,t,n=(r=n,e=m[i],o=[],n=[],t=[],e.forEach(function(n,e){t.push(s(r,n,r[f[e]]))}),l(r,t,o,n));u(n)},[i]);var o=(0,d.useCallback)(function(){e&&r&&function(){_.apply(this,arguments)}(e,r,h)},[e,r]);return requestAnimationFrame(function(){o()}),(0,R.jsxs)("main",{className:v()("container-fluid","bg-light d-flex flex-column justify-content-center align-items-center",x.height),children:[(0,R.jsx)("h1",{className:"mb-4 text-warning",children:"WebGL 处理图片 - 我妻善逸⚡️"}),(0,R.jsx)("canvas",{ref:a,id:"canvas"})]})};i=r("/L9P"),r={insert:"head",singleton:!1},u()(i.Z,r);const A=i.Z.locals||{};var C=v()("list-group-item bg-transparent text-truncate",A.listItem);const w=function(n){var e=n.onChangeType;return(0,R.jsx)("section",{className:v()("position-fixed start-0 top-0 bg-secondary",A.sider),children:(0,R.jsxs)("ul",{className:v()("list-group list-group-flush",A.list),children:[(0,R.jsx)("li",{className:C,onClick:function(){e(o.Origin)},children:"原图"}),(0,R.jsx)("li",{className:C,onClick:function(){e(o.Gray)},children:"灰白"}),(0,R.jsx)("li",{className:C,onClick:function(){e(o.RevertBlueAndRed)},children:"交换红蓝通道"}),(0,R.jsx)("li",{className:C,onClick:function(){e(o.Blur)},children:"高斯模糊"}),(0,R.jsx)("li",{className:C,onClick:function(){e(o.Random)},children:"马赛克"})]})})};(0,t.render)((0,R.jsx)(function(){var n=(0,d.useState)(o.Origin),e=n[0],r=n[1];return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(w,{onChangeType:function(n){r(n)}}),(0,R.jsx)(E,{type:e})]})},{}),document.querySelector("#app"))},"9nyN":(n,e,r)=>{"use strict";r.d(e,{Z:()=>o});e=r("JPst"),e=r.n(e)()(function(n){return n[1]});e.push([n.id,"._20ZAZ_MnqoCDcCETNYMimk {\n  height: 100vh;\n}\n",""]),e.locals={height:"_20ZAZ_MnqoCDcCETNYMimk"};const o=e},"/L9P":(n,e,r)=>{"use strict";r.d(e,{Z:()=>o});e=r("JPst"),e=r.n(e)()(function(n){return n[1]});e.push([n.id,"._2OBmmDmWH12n1QOz3ndhHE {\n  width: 15vw;\n  height: 100%;\n  padding-top: 3rem;\n}\n.SojjSYU75qURKWaa4i9zt {\n  color: rgba(255, 255, 255, 0.8);\n}\n.SojjSYU75qURKWaa4i9zt:hover {\n  cursor: pointer;\n}\n@media screen and (max-width: 750px) {\n  ._2OBmmDmWH12n1QOz3ndhHE {\n    width: 100%;\n    height: 6vh;\n    padding-top: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  ._2OUv54NEGUV31UWWOm0fkz {\n    flex-direction: row;\n    width: 100%;\n  }\n  .SojjSYU75qURKWaa4i9zt {\n    border: none;\n  }\n}\n",""]),e.locals={sider:"_2OBmmDmWH12n1QOz3ndhHE",listItem:"SojjSYU75qURKWaa4i9zt",list:"_2OUv54NEGUV31UWWOm0fkz"};const o=e}},n=>{"use strict";n.O(0,["vendors"],()=>n(n.s="w6CO"));n.O()}]);